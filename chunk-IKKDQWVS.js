import{b as oe,c as u,d as ae,e as le,f as se,g as ce,h as de,i as me,j as pe,k as ue,l as fe,m as ge,n as xe,o as be}from"./chunk-RMOKHK5R.js";import{a as L,b as he}from"./chunk-KLJFRL5B.js";import{a as ye}from"./chunk-PDJXZ3JQ.js";import"./chunk-IKQLUHYN.js";import{r as j}from"./chunk-KHQP2C4F.js";import{$a as _,Ab as o,Bb as h,Cb as F,Db as D,Hb as K,I as z,Ib as d,Jb as y,Kb as w,Lb as Q,Mb as T,O as M,R as V,Ta as a,Y as C,ba as E,bc as W,eb as c,fa as H,ga as I,hb as s,kb as i,lb as n,mb as p,nb as v,o as U,oa as R,ob as S,pa as B,pb as O,pc as X,qb as P,qc as Y,rb as g,rc as Z,s as $,sc as ee,t as q,ta as J,tc as te,uc as ne,wc as ie,xc as re,z as G,zb as b}from"./chunk-YYSJSBRX.js";var Se=(t,r)=>({"text-emerald-500":t,"text-rose-500":r});function we(t,r){if(t&1&&(i(0,"option",41),o(1),n()),t&2){let e=r.$implicit;s("value",e.id),a(),F(" ",e.name," ")}}function Te(t,r){if(t&1){let e=O();v(0),i(1,"select",39,4),P("change",function(){R(e);let m=b(2),x=g();return B(x.changeAccountFilter(m.value||null))}),i(3,"option",40),o(4,"All accounts"),n(),c(5,we,2,2,"option",22),n(),S()}if(t&2){let e,l=r.ngIf,m=g();a(),s("value",(e=m.selectedAccountId())!==null&&e!==void 0?e:""),a(4),s("ngForOf",l)}}function Ce(t,r){t&1&&(i(0,"div",42),p(1,"div",43),n())}function Ee(t,r){if(t&1&&(v(0),i(1,"div",44)(2,"div",45)(3,"span"),o(4,"Inflows: "),i(5,"strong",46),o(6),d(7,"currency"),n()(),i(8,"span"),o(9,"Outflows: "),i(10,"strong",47),o(11),d(12,"currency"),n()(),i(13,"span"),o(14,"Net: "),i(15,"strong",48),o(16),d(17,"currency"),n()()()(),S()),t&2){let e=r.ngIf;a(6),h(w(7,3,e.inflows,"USD")),a(5),h(w(12,6,e.outflows,"USD")),a(5),h(w(17,9,e.inflows-e.outflows,"USD"))}}function Ie(t,r){t&1&&p(0,"span",51)}function Fe(t,r){if(t&1&&(i(0,"div",49)(1,"div",45),c(2,Ie,1,0,"span",50),n()()),t&2){let e=g();a(2),s("ngForOf",e.totalSkeletons)}}function De(t,r){if(t&1&&(i(0,"option",41),o(1),n()),t&2){let e=r.$implicit;s("value",e.id),a(),D(" ",e.name," \xB7 ",e.accountNumber," ")}}function Ae(t,r){t&1&&(v(0),o(1,"Log transaction"),S())}function Ne(t,r){if(t&1&&(i(0,"p",52),o(1),n()),t&2){let e=g();a(),F(" ",e.createSuccess()," ")}}function ke(t,r){if(t&1&&(i(0,"p",53),o(1),n()),t&2){let e=g();a(),F(" ",e.createError()," ")}}function $e(t,r){t&1&&(i(0,"span",54),p(1,"span",55),o(2," Saving\u2026 "),n())}function Me(t,r){if(t&1&&(i(0,"article",59)(1,"div")(2,"p",60),o(3),n(),i(4,"p",61),o(5),d(6,"date"),n()(),i(7,"div",62)(8,"p",63),o(9),d(10,"currency"),n(),i(11,"p",61),o(12),d(13,"titlecase"),n()()()),t&2){let e=r.$implicit;a(3),h(e.description),a(2),D("",e.category," \xB7 ",w(6,7,e.date,"medium")," "),a(3),s("ngClass",K(17,Se,e.direction==="credit",e.direction==="debit")),a(),D(" ",e.direction==="credit"?"+":"-","",Q(10,10,e.amount,e.currency,!1,"1.2-2")," "),a(3),h(y(13,15,e.status))}}function Ve(t,r){t&1&&(i(0,"p",64),o(1," No transactions found for this filter. "),n())}function Re(t,r){if(t&1&&(v(0),i(1,"div",56),c(2,Me,14,20,"article",57)(3,Ve,2,0,"p",58),n(),S()),t&2){let e=r.ngIf;a(2),s("ngForOf",e),a(),s("ngIf",!e.length)}}function Be(t,r){t&1&&(i(0,"article",59)(1,"div",12),p(2,"div",66)(3,"div",67),n(),i(4,"div",68),p(5,"div",69)(6,"div",70),n()())}function Oe(t,r){if(t&1&&(i(0,"div",65),c(1,Be,7,0,"article",57),n()),t&2){let e=g();a(),s("ngForOf",e.transactionSkeletons)}}var A=class t{bankData=E(ye);fb=E(xe);destroyRef=E(J);refreshTrigger$=G(U(void 0),this.bankData.refresh$);accounts$=this.refreshTrigger$.pipe(V(()=>this.bankData.getAccounts()),M({bufferSize:1,refCount:!0}));transactions$=this.refreshTrigger$.pipe(V(()=>this.bankData.getTransactions()),M({bufferSize:1,refCount:!0}));selectedAccountId=_(null);isCreating=_(!1);createError=_(null);createSuccess=_(null);newTransactionForm=this.fb.nonNullable.group({accountId:["",u.required],description:["",[u.required,u.maxLength(80)]],category:["Miscellaneous",[u.required,u.maxLength(40)]],amount:[50,[u.required,u.min(1)]],direction:["debit",u.required]});filteredTransactions$=q([this.transactions$,he(this.selectedAccountId)]).pipe($(([r,e])=>this.sortTransactions(e?r.filter(l=>l.accountId===e):r)));totalForSelection$=this.filteredTransactions$.pipe($(r=>r.reduce((e,l)=>(l.direction==="credit"?e.inflows+=l.amount:e.outflows+=l.amount,e),{inflows:0,outflows:0})));selectedAccountLabel=W(()=>this.selectedAccountId());transactionSkeletons=Array.from({length:6});totalSkeletons=Array.from({length:3});constructor(){this.accounts$.pipe(L(this.destroyRef)).subscribe(r=>{if(!r.length)return;let e=r[0].id;this.newTransactionForm.controls.accountId.value||this.newTransactionForm.controls.accountId.setValue(e)})}changeAccountFilter(r){this.selectedAccountId.set(r)}submitNewTransaction(){if(this.newTransactionForm.invalid){this.newTransactionForm.markAllAsTouched();return}let{accountId:r,amount:e,direction:l,description:m,category:x}=this.newTransactionForm.getRawValue();this.isCreating.set(!0),this.createError.set(null),this.createSuccess.set(null),this.bankData.createTransaction({accountId:r,amount:e,direction:l,description:m,category:x}).pipe(L(this.destroyRef),z(()=>this.isCreating.set(!1))).subscribe({next:f=>{this.createSuccess.set(`${f.description} logged for ${f.amount.toLocaleString("en-US",{style:"currency",currency:f.currency})}.`),this.newTransactionForm.patchValue({description:"",category:"Miscellaneous",amount:50})},error:f=>{let k=f instanceof Error?f.message:"Unable to create transaction.";this.createError.set(k)}})}sortTransactions(r){return[...r].sort((e,l)=>new Date(l.date).getTime()-new Date(e.date).getTime())}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=H({type:t,selectors:[["app-transactions"]],decls:75,vars:21,consts:[["accountSelectSkeleton",""],["totalSkeleton",""],["creatingTransaction",""],["transactionsSkeleton",""],["accountFilterSelect",""],[1,"bg-white"],[1,"mx-auto","max-w-6xl","px-6","py-20"],[1,"rounded-3xl","border","border-slate-200","bg-white/95","p-10","shadow-sm"],[1,"text-3xl","font-semibold","text-midnight"],[1,"mt-4","text-slate-500"],[1,"mt-8","grid","gap-6","lg:grid-cols-[1.6fr,1fr]"],[1,"space-y-6"],[1,"space-y-2"],["for","accountFilter",1,"text-sm","font-medium","text-midnight"],[4,"ngIf","ngIfElse"],[1,"rounded-2xl","border","border-slate-200","bg-white","p-6"],[1,"text-lg","font-semibold","text-midnight"],[1,"mt-2","text-sm","text-slate-500"],[1,"mt-4","space-y-4","text-sm","text-slate-600",3,"ngSubmit","formGroup"],["for","transactionAccount",1,"text-sm","font-medium","text-midnight"],["id","transactionAccount","formControlName","accountId",1,"w-full","rounded-2xl","border","border-slate-200","bg-white","px-4","py-3","text-sm","text-midnight","focus:border-midnight","focus:outline-none","focus:ring-2","focus:ring-midnight/20"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["for","transactionDescription",1,"text-sm","font-medium","text-midnight"],["id","transactionDescription","type","text","formControlName","description","placeholder","e.g. Freelance payout",1,"w-full","rounded-2xl","border","border-slate-200","bg-white","px-4","py-3","text-sm","text-midnight","focus:border-midnight","focus:outline-none","focus:ring-2","focus:ring-midnight/20"],["for","transactionCategory",1,"text-sm","font-medium","text-midnight"],["id","transactionCategory","type","text","formControlName","category","placeholder","Category",1,"w-full","rounded-2xl","border","border-slate-200","bg-white","px-4","py-3","text-sm","text-midnight","focus:border-midnight","focus:outline-none","focus:ring-2","focus:ring-midnight/20"],[1,"grid","gap-4","md:grid-cols-2"],["for","transactionAmount",1,"text-sm","font-medium","text-midnight"],["id","transactionAmount","type","number","min","1","step","0.01","formControlName","amount",1,"w-full","rounded-2xl","border","border-slate-200","bg-white","px-4","py-3","text-sm","text-midnight","focus:border-midnight","focus:outline-none","focus:ring-2","focus:ring-midnight/20"],["for","transactionDirection",1,"text-sm","font-medium","text-midnight"],["id","transactionDirection","formControlName","direction",1,"w-full","rounded-2xl","border","border-slate-200","bg-white","px-4","py-3","text-sm","text-midnight","focus:border-midnight","focus:outline-none","focus:ring-2","focus:ring-midnight/20"],["value","debit"],["value","credit"],["type","submit",1,"inline-flex","w-full","items-center","justify-center","rounded-full","bg-midnight","px-6","py-3","text-sm","font-medium","text-white","transition","hover:bg-slate-900","disabled:cursor-not-allowed","disabled:opacity-70",3,"disabled"],["class","rounded-2xl border border-emerald-100 bg-emerald-50 px-4 py-3 text-xs text-emerald-600",4,"ngIf"],["class","rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-xs text-rose-600",4,"ngIf"],[1,"rounded-2xl","border","border-slate-200","bg-mist/70","p-6","text-sm","text-slate-600"],[1,"mt-3","space-y-2"],["id","accountFilter",1,"w-full","rounded-2xl","border","border-slate-200","bg-white","px-4","py-3","text-sm","text-midnight","focus:border-midnight","focus:outline-none","focus:ring-2","focus:ring-midnight/20",3,"change","value"],["value",""],[3,"value"],["aria-hidden","true",1,"animate-pulse"],[1,"h-11","w-64","rounded-2xl","bg-slate-200"],["role","status","aria-live","polite",1,"rounded-2xl","border","border-slate-200","bg-mist","px-6","py-4","text-sm","text-slate-600"],[1,"flex","flex-wrap","items-center","gap-4"],[1,"text-emerald-600"],[1,"text-rose-500"],[1,"text-midnight"],["aria-hidden","true","aria-busy","true",1,"rounded-2xl","border","border-slate-200","bg-mist","px-6","py-4","animate-pulse"],["class","h-4 w-28 rounded bg-slate-200",4,"ngFor","ngForOf"],[1,"h-4","w-28","rounded","bg-slate-200"],[1,"rounded-2xl","border","border-emerald-100","bg-emerald-50","px-4","py-3","text-xs","text-emerald-600"],[1,"rounded-2xl","border","border-rose-200","bg-rose-50","px-4","py-3","text-xs","text-rose-600"],[1,"inline-flex","items-center","gap-2"],[1,"h-2","w-2","animate-ping","rounded-full","bg-white"],[1,"space-y-3"],["class","flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-5 py-4 text-sm",4,"ngFor","ngForOf"],["class","rounded-2xl border border-slate-200 bg-white px-5 py-4 text-sm text-slate-500",4,"ngIf"],[1,"flex","items-center","justify-between","rounded-2xl","border","border-slate-200","bg-white","px-5","py-4","text-sm"],[1,"font-medium","text-midnight"],[1,"text-xs","text-slate-400"],[1,"text-right"],[1,"text-base","font-semibold",3,"ngClass"],[1,"rounded-2xl","border","border-slate-200","bg-white","px-5","py-4","text-sm","text-slate-500"],["aria-hidden","true",1,"space-y-3","animate-pulse"],[1,"h-4","w-48","rounded","bg-slate-200"],[1,"h-3","w-32","rounded","bg-slate-100"],[1,"space-y-2","text-right"],[1,"h-5","w-20","rounded","bg-slate-200","ml-auto"],[1,"h-3","w-16","rounded","bg-slate-100","ml-auto"]],template:function(e,l){if(e&1){let m=O();i(0,"section",5)(1,"div",6)(2,"div",7)(3,"h1",8),o(4,"Transactions stream"),n(),i(5,"p",9),o(6," Filter the live ledger by account and inspect inflows/outflows. Powered entirely by the Angular in-memory web API. "),n(),i(7,"div",10)(8,"div",11)(9,"div",12)(10,"label",13),o(11,"Show transactions for"),n(),c(12,Te,6,2,"ng-container",14),d(13,"async"),n(),c(14,Ce,2,0,"ng-template",null,0,T)(16,Ee,18,12,"ng-container",14),d(17,"async"),c(18,Fe,3,1,"ng-template",null,1,T),i(20,"section",15)(21,"h2",16),o(22,"Log manual transaction"),n(),i(23,"p",17),o(24,"Perfect for testing balance updates or simulating new activity before a real backend arrives."),n(),i(25,"form",18),P("ngSubmit",function(){return R(m),B(l.submitNewTransaction())}),i(26,"div",12)(27,"label",19),o(28,"Account"),n(),i(29,"select",20)(30,"option",21),o(31,"Select account"),n(),c(32,De,2,3,"option",22),d(33,"async"),n()(),i(34,"div",12)(35,"label",23),o(36,"Description"),n(),p(37,"input",24),n(),i(38,"div",12)(39,"label",25),o(40,"Category"),n(),p(41,"input",26),n(),i(42,"div",27)(43,"div",12)(44,"label",28),o(45,"Amount"),n(),p(46,"input",29),n(),i(47,"div",12)(48,"label",30),o(49,"Direction"),n(),i(50,"select",31)(51,"option",32),o(52,"Debit (money out)"),n(),i(53,"option",33),o(54,"Credit (money in)"),n()()()(),i(55,"button",34),c(56,Ae,2,0,"ng-container",14),n(),c(57,Ne,2,1,"p",35)(58,ke,2,1,"p",36),n()(),c(59,$e,3,0,"ng-template",null,2,T)(61,Re,4,2,"ng-container",14),d(62,"async"),c(63,Oe,2,1,"ng-template",null,3,T),n(),i(65,"aside",37)(66,"h2",16),o(67,"Next enhancements"),n(),i(68,"ul",38)(69,"li"),o(70,"\u{1F9FE} Add export to CSV using the filtered dataset."),n(),i(71,"li"),o(72,"\u{1F50D} Drop in full-text search over merchant, memo, or category."),n(),i(73,"li"),o(74,"\u26A1 Swap the mock API with real services and keep this template."),n()()()()()()()}if(e&2){let m=b(15),x=b(19),f=b(60),k=b(64);a(12),s("ngIf",y(13,13,l.accounts$))("ngIfElse",m),a(4),s("ngIf",y(17,15,l.totalForSelection$))("ngIfElse",x),a(9),s("formGroup",l.newTransactionForm),a(7),s("ngForOf",y(33,17,l.accounts$)),a(23),s("disabled",l.newTransactionForm.invalid||l.isCreating()),a(),s("ngIf",!l.isCreating())("ngIfElse",f),a(),s("ngIf",l.createSuccess()),a(),s("ngIf",l.createError()),a(3),s("ngIf",y(62,19,l.filteredTransactions$))("ngIfElse",k)}},dependencies:[X,Y,Z,se,ue,fe,oe,ce,pe,ae,le,ge,de,me,ee,te,ie,ne],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})};var Pe=[{path:"",component:A}],N=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=I({type:t});static \u0275inj=C({imports:[j.forChild(Pe),j]})};var ve=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=I({type:t});static \u0275inj=C({imports:[re,N,be]})};export{ve as TransactionsModule};

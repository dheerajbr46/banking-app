import{b as O}from"./chunk-QJRJY3BR.js";import{b as W,c as d,d as H,e as J,f as K,h as Q,i as X,n as Y,o as Z}from"./chunk-7T5PGW3B.js";import{a as _,c as ee}from"./chunk-CNJIAFHZ.js";import{a as te}from"./chunk-TAB4Y5YQ.js";import{s as E}from"./chunk-O2OYFZXD.js";import{A as I,Ab as A,Bb as i,Cb as B,Db as S,J as N,Nb as G,P as D,R as y,S as F,Ua as l,Z as u,ab as g,ca as p,cc as q,fb as f,ga as M,ha as x,ib as s,lb as t,mb as e,nb as b,o as C,ob as U,pa as k,pb as V,qa as R,qb as j,rb as $,s as w,sb as c,sc as z,t as P,ua as T,yc as L}from"./chunk-DEEXOUVC.js";function ne(n,o){n&1&&(U(0),i(1,"Save settings"),V())}function oe(n,o){if(n&1&&(t(0,"p",33),i(1),e()),n&2){let r=c(2);l(),S(" ",r.saveSuccess()," ")}}function le(n,o){if(n&1&&(t(0,"p",34),i(1),e()),n&2){let r=c(2);l(),S(" ",r.saveError()," ")}}function ae(n,o){n&1&&(t(0,"span",35),b(1,"span",36),i(2," Saving\u2026 "),e())}function se(n,o){if(n&1){let r=j();t(0,"div",7)(1,"div",8)(2,"section",9)(3,"h2",10),i(4,"Personal information"),e(),t(5,"form",11),$("ngSubmit",function(){k(r);let a=c();return R(a.submitProfile())}),t(6,"div",12)(7,"label",13),i(8,"Name"),e(),b(9,"input",14),e(),t(10,"div",12)(11,"label",15),i(12,"Email"),e(),b(13,"input",16),e(),t(14,"div",12)(15,"span",17),i(16,"Customer ID"),e(),t(17,"p",18),i(18),e()(),t(19,"button",19),f(20,ne,2,0,"ng-container",20),e(),f(21,oe,2,1,"p",21)(22,le,2,1,"p",22),e(),f(23,ae,3,0,"ng-template",null,0,G),e(),t(25,"section",9)(26,"h2",10),i(27,"Notification preferences"),e(),t(28,"ul",23)(29,"li",24)(30,"span",25),i(31,"Balance alerts"),e(),t(32,"span",26),i(33,"Enabled"),e()(),t(34,"li",24)(35,"span",25),i(36,"Security notices"),e(),t(37,"span",26),i(38,"Enabled"),e()(),t(39,"li",24)(40,"span",25),i(41,"Offers & rewards"),e(),t(42,"span",27),i(43,"Paused"),e()()()()(),t(44,"section",28)(45,"h2",10),i(46,"Security centre"),e(),t(47,"div",29)(48,"div",30)(49,"p",18),i(50,"Biometric sign-in"),e(),t(51,"p",31),i(52,"Demo toggle ready for Face ID / Touch ID integration."),e()(),t(53,"div",30)(54,"p",18),i(55,"Trusted devices"),e(),t(56,"p",31),i(57,"MacBook Pro \xB7 last active 2 minutes ago."),e()(),t(58,"div",30)(59,"p",18),i(60,"Multi-factor authentication"),e(),t(61,"p",31),i(62,"SMS + Authenticator app configured."),e()()(),t(63,"button",32),i(64,"Reset password"),e()()()}if(n&2){let r=o.ngIf,m=A(24),a=c();l(5),s("formGroup",a.profileForm),l(13),B(r.id),l(),s("disabled",a.profileForm.invalid||a.isSaving()),l(),s("ngIf",!a.isSaving())("ngIfElse",m),l(),s("ngIf",a.saveSuccess()),l(),s("ngIf",a.saveError())}}var v=class n{authService=p(O);bankData=p(te);fb=p(Y);destroyRef=p(T);refreshTrigger$=I(C(void 0),this.bankData.refresh$);profileStream$=this.refreshTrigger$.pipe(F(()=>P([this.authService.currentUser$.pipe(y(null)),this.bankData.getUserProfile().pipe(y(null))])),w(([o,r])=>o??r??null),D({bufferSize:1,refCount:!0}));profileSignal=ee(this.profileStream$,{initialValue:null});profile=q(()=>this.profileSignal());profileForm=this.fb.nonNullable.group({id:["",d.required],name:["",[d.required,d.maxLength(60)]],email:["",[d.required,d.email]]});isSaving=g(!1);saveError=g(null);saveSuccess=g(null);constructor(){this.profileStream$.pipe(_(this.destroyRef)).subscribe(o=>{o&&this.profileForm.reset(o)})}submitProfile(){if(this.profileForm.invalid){this.profileForm.markAllAsTouched();return}let o=this.profileForm.getRawValue();this.isSaving.set(!0),this.saveError.set(null),this.saveSuccess.set(null),this.bankData.updateUserProfile(o).pipe(_(this.destroyRef),N(()=>this.isSaving.set(!1))).subscribe({next:r=>{this.authService.updateSessionProfile(r),this.saveSuccess.set("Profile updated.")},error:r=>{let m=r instanceof Error?r.message:"Unable to update profile.";this.saveError.set(m)}})}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=M({type:n,selectors:[["app-profile"]],decls:8,vars:1,consts:[["savingProfile",""],[1,"bg-white"],[1,"mx-auto","max-w-5xl","px-6","py-20"],[1,"rounded-3xl","border","border-slate-200","bg-white/95","p-10","shadow-sm"],[1,"text-3xl","font-semibold","text-midnight"],[1,"mt-4","text-slate-500"],["class","mt-8 grid gap-6 md:grid-cols-2",4,"ngIf"],[1,"mt-8","grid","gap-6","md:grid-cols-2"],[1,"space-y-4","rounded-2xl","border","border-slate-200","bg-mist/70","p-6","text-sm","text-slate-600"],[1,"rounded-xl","border","border-slate-200","bg-white","p-5"],[1,"text-lg","font-semibold","text-midnight"],[1,"mt-4","space-y-4","text-sm","text-slate-600",3,"ngSubmit","formGroup"],[1,"space-y-1"],["for","profileName",1,"text-xs","uppercase","tracking-wide","text-slate-400"],["id","profileName","type","text","formControlName","name",1,"w-full","rounded-xl","border","border-slate-200","bg-white","px-3","py-2","text-sm","text-midnight","focus:border-midnight","focus:outline-none","focus:ring-2","focus:ring-midnight/20"],["for","profileEmail",1,"text-xs","uppercase","tracking-wide","text-slate-400"],["id","profileEmail","type","email","formControlName","email",1,"w-full","rounded-xl","border","border-slate-200","bg-white","px-3","py-2","text-sm","text-midnight","focus:border-midnight","focus:outline-none","focus:ring-2","focus:ring-midnight/20"],[1,"text-xs","uppercase","tracking-wide","text-slate-400"],[1,"font-medium","text-midnight"],["type","submit",1,"inline-flex","w-full","items-center","justify-center","rounded-full","bg-midnight","px-4","py-2","text-sm","font-medium","text-white","transition","hover:bg-slate-900","disabled:opacity-70",3,"disabled"],[4,"ngIf","ngIfElse"],["class","rounded-xl border border-emerald-100 bg-emerald-50 px-4 py-3 text-xs text-emerald-600",4,"ngIf"],["class","rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-xs text-rose-600",4,"ngIf"],[1,"mt-4","space-y-3","text-sm"],[1,"flex","items-center","justify-between"],[1,"text-slate-600"],[1,"rounded-full","bg-emerald-100","px-3","py-1","text-xs","font-medium","text-emerald-700"],[1,"rounded-full","bg-slate-200","px-3","py-1","text-xs","font-medium","text-slate-600"],[1,"space-y-4","rounded-2xl","border","border-slate-200","bg-white","p-6","text-sm","text-slate-600"],[1,"space-y-3"],[1,"rounded-xl","border","border-slate-200","bg-mist","px-4","py-3"],[1,"text-xs","text-slate-500"],["mat-flat-button","","color","primary",1,"!bg-midnight","hover:!bg-slate-900"],[1,"rounded-xl","border","border-emerald-100","bg-emerald-50","px-4","py-3","text-xs","text-emerald-600"],[1,"rounded-xl","border","border-rose-200","bg-rose-50","px-4","py-3","text-xs","text-rose-600"],[1,"inline-flex","items-center","gap-2"],[1,"h-2","w-2","animate-ping","rounded-full","bg-white"]],template:function(r,m){r&1&&(t(0,"section",1)(1,"div",2)(2,"div",3)(3,"h1",4),i(4,"Profile & preferences"),e(),t(5,"p",5),i(6," Review the demo user profile pulled from the mock API and toggle notification or security preferences as you connect real services. "),e(),f(7,se,65,7,"div",6),e()()()),r&2&&(l(7),s("ngIf",m.profile()))},dependencies:[z,K,W,H,J,Q,X],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})};var me=[{path:"",component:v}],h=class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=x({type:n});static \u0275inj=u({imports:[E.forChild(me),E]})};var re=class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=x({type:n});static \u0275inj=u({imports:[L,h,Z]})};export{re as ProfileModule};
